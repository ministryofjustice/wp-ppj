!function(t){"use strict";t((function(){var e="ccfw_wp_plugin.banner.hidden",i="ccfw_wp_plugin.ga.accept",o={init:function(){this.$el=t("#ccfw-page-banner"),this.$body=t("body"),this.$html=t("html")}},n={init:function(){this.cacheDom(),this.bindEvents()},cacheDom:function(){this.$el=o.$el,this.$settingsModal=this.$el.find("#cookie-popup"),this.$body=o.$body,this.$html=o.$html,this.$cookieSettingsButton=this.$body.find("#js-ccfw-settings-button")},bindEvents:function(){this.$cookieSettingsButton.on("click",this.showBanner.bind(this))},getCookie:function(t){var e=("; "+document.cookie).split("; "+t+"=");if(2===e.length)return e.pop().split(";").shift()},setCookie:function(t,e,i){var o=new Date;o.setTime(o.getTime()+864e5*i),document.cookie=t+"="+e+"; path=/; expires="+o.toGMTString()},deleteCookie:function(t){document.cookie=t+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"},checkForCookie:function(t){return void 0!==this.getCookie(t)},showBanner:function(){this.$el.show(),this.$cookieSettingsButton.hide(),this.toggleAriaHidden(this.$el,"hide")},hideBanner:function(){this.$el.hide(),this.toggleAriaHidden(this.$el,"unhide"),this.$cookieSettingsButton.show()},hideSettingsModal:function(){this.$settingsModal.hide(),this.$body.removeClass("ccfw-modal-open"),this.$el.removeClass("ccfw-cookie-banner-open"),this.$html.removeClass("ccfw-cookie-banner-open"),this.$body.removeClass("ccfw-cookie-banner-open")},showSettingsModal:function(){this.$settingsModal.show(),this.$body.addClass("ccfw-modal-open"),this.$el.addClass("ccfw-cookie-banner-open"),this.$html.addClass("ccfw-cookie-banner-open"),this.$body.addClass("ccfw-cookie-banner-open"),n.checkForCookie(i)&&c.$GAcheckBox.attr("aria-checked",!0),c.trapSettingsFocus(),"true"===c.$GAcheckBox.attr("aria-checked")?(c.$gaToggleOnText.show(),c.$gaToggleOffText.hide()):(c.$gaToggleOffText.show(),c.$gaToggleOnText.hide())},toggleAriaHidden:function(t,e){for(var i=[],o=t.parent().children();o;)o!==t&&i.push(o),o=o.nextSibling;"hide"===e?i.forEach((function(e){e.attr("aria-hidden","true"),t.removeAttr("aria-hidden","true")})):i.forEach((function(t){t.removeAttr("aria-hidden","true")}))}},s={init:function(){this.cacheDom(),this.bindEvents(),this.bannerDisplay()},cacheDom:function(){this.$el=o.$el,this.$buttonAccept=this.$el.find("#cookie-accept"),this.$buttonDecline=this.$el.find("#cookie-decline"),this.$buttonInfo=this.$el.find("#cookie-more-info")},bindEvents:function(){this.$buttonAccept.on("click",this.acceptAllButton.bind(this)),this.$buttonDecline.on("click",this.declineAllButton.bind(this)),this.$buttonInfo.on("click",this.chooseCookieSettingsButton.bind(this))},bannerDisplay:function(){!1===n.checkForCookie(e)?(n.showBanner(),this.trapBannerFocus()):n.hideBanner()},trapBannerFocus:function(){var e=t(".ccfw-banner__buttons"),i=t(".ccfw-banner__buttons #cookie-accept, .ccfw-banner__buttons #cookie-decline, .ccfw-banner__buttons #cookie-more-info"),o=i[0],n=i[i.length-1];e.on("keydown",(function(t){"Tab"===t.key&&(t.shiftKey?document.activeElement===o&&(n.focus(),t.preventDefault()):document.activeElement===n&&(o.focus(),t.preventDefault()))}))},acceptAllButton:function(){n.setCookie(e,"true",365),n.setCookie(i,"true",365),n.hideBanner()},declineAllButton:function(){n.setCookie(e,"true",365),n.deleteCookie(i),n.hideBanner()},chooseCookieSettingsButton:function(){n.showSettingsModal()}},c={init:function(){this.cacheDom(),this.bindEvents()},cacheDom:function(){this.$el=o.$el,this.$settingsModal=this.$el.find("#cookie-popup"),this.$buttonAccept=this.$settingsModal.find("#cookie-accept"),this.$buttonDecline=this.$settingsModal.find("#cookie-decline"),this.$buttonInfo=this.$settingsModal.find("#cookie-more-info"),this.$buttonSavePreferences=this.$settingsModal.find("#cookie-save-preferences"),this.$GAcheckBox=this.$settingsModal.find("#ccfw-analytics-cookies-toggle"),this.$buttonModalClose=this.$settingsModal.find("#ccfw-modal-close"),this.$body=o.$body,this.$gaToggleOnText=this.$settingsModal.find("#ccfw-ga-toggle-on"),this.$gaToggleOffText=this.$settingsModal.find("#ccfw-ga-toggle-off")},bindEvents:function(){this.$buttonModalClose.on("click",this.modalDisplay.bind(this)),this.$buttonInfo.on("click",this.trapSettingsFocus.bind(this)),this.$buttonSavePreferences.on("click",this.saveCookiePreferences.bind(this)),this.$GAcheckBox.on("click",this.toggleAriaPressed.bind(this))},modalDisplay:function(){n.hideSettingsModal()},toggleAriaPressed:function(){var t="true"===this.$GAcheckBox.attr("aria-checked");this.$GAcheckBox.attr("aria-checked",!t),t?(this.$gaToggleOffText.show(),this.$gaToggleOnText.hide()):(this.$gaToggleOnText.show(),this.$gaToggleOffText.hide())},trapSettingsFocus:function(){this.$settingsModal.focus();var e=t('#cookie-popup a[href], #cookie-popup details, #cookie-popup button, #cookie-popup input[type="checkbox"]'),i=e[0],o=e[e.length-1];this.$el.on("keydown",(function(t){"Escape"===t.key&&n.hideSettingsModal(),"Tab"===t.key&&(t.shiftKey?document.activeElement===i&&(o.focus(),t.preventDefault()):document.activeElement===o&&(i.focus(),t.preventDefault()))}))},saveCookiePreferences:function(){var t="true"===this.$GAcheckBox.attr("aria-checked");!0===t&&n.setCookie(i,"true",365),!1===t&&n.checkForCookie(i)&&n.deleteCookie(i),n.setCookie(e,"true",365),n.hideBanner(),n.hideSettingsModal()}};o.init(),n.init(),s.init(),c.init()}))}(jQuery);